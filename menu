#!/bin/bash

# ================= COLORS =================
RED="\e[31m"
GREEN="\e[32m"
YELLOW="\e[33m"
CYAN="\e[36m"
WHITE="\e[37m"
MAGENTA="\e[35m"
RESET="\e[0m"
BOLD="\e[1m"

# ================= CURL CHECK =================
check_curl() {
if ! command -v curl &>/dev/null; then
  echo -e "${RED}${BOLD}curl not found! Installing...${RESET}"
  if command -v apt-get &>/dev/null; then
    sudo apt-get update && sudo apt-get install -y curl
  elif command -v yum &>/dev/null; then
    sudo yum install -y curl
  elif command -v dnf &>/dev/null; then
    sudo dnf install -y curl
  else
    echo -e "${RED}Please install curl manually.${RESET}"
    exit 1
  fi
fi
}

# ================= RUN REMOTE SCRIPT =================
run_remote_script() {
local url=$1
check_curl
tmp=$(mktemp)

echo -e "${YELLOW}${BOLD}Downloading script...${RESET}"
if curl -fsSL "$url" -o "$tmp"; then
  chmod +x "$tmp"
  bash "$tmp"
else
  echo -e "${RED}${BOLD}Failed to download script!${RESET}"
fi

rm -f "$tmp"
read -p "Press Enter to continue..."
}

# ================= SYSTEM INFO (FIXED) =================
system_info() {
clear
echo -e "${CYAN}${BOLD}SYSTEM INFORMATION${RESET}"
echo "Hostname : $(hostname)"
echo "User     : $(whoami)"
echo "OS       : $(uname -srm)"
echo "Uptime   : $(uptime -p)"

# Memory (safe)
if command -v free &>/dev/null; then
  echo "Memory   : $(free -h | awk '/Mem:/ {print $3\"/\"$2}')"
else
  mem_total=$(awk '/MemTotal/ {printf "%.2f GB", $2/1024/1024}' /proc/meminfo)
  mem_free=$(awk '/MemAvailable/ {printf "%.2f GB", $2/1024/1024}' /proc/meminfo)
  echo "Memory   : $mem_free / $mem_total"
fi

# Disk
echo "Disk     : $(df -h / | awk 'NR==2 {print $3\"/\"$2 \" (\"$5\")\"}')"

echo
read -p "Press Enter to continue..."
}

# ================= MENU =================
show_menu() {
clear
echo -e "${MAGENTA}${BOLD}
  _____      _                
 |  __ \\    (_)               
 | |__) | __ _ _ __   ___ ___ 
 |  ___/ '__| | '_ \\ / __/ _ \\
 | |   | |  | | | | | (_|  __/
 |_|   |_|  |_|_| |_|\\___\\___|
${RESET}"

echo -e "${CYAN}${BOLD}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${RESET}"
echo -e "${YELLOW}${BOLD}        ğŸš€ PTERO CONTROL MENU ğŸš€        ${RESET}"
echo -e "${CYAN}${BOLD}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${RESET}"

echo -e "${GREEN}${BOLD} [1]${WHITE} Ptero Panel Install${RESET}"
echo -e "${GREEN}${BOLD} [2]${WHITE} Ptero Wing Install${RESET}"
echo -e "${GREEN}${BOLD} [3]${WHITE} Ptero Update${RESET}"
echo -e "${GREEN}${BOLD} [4]${WHITE} Ptero Uninstall${RESET}"
echo -e "${GREEN}${BOLD} [5]${WHITE} Blueprint Install${RESET}"
echo -e "${GREEN}${BOLD} [6]${WHITE} Cloudflare Install${RESET}"
echo -e "${GREEN}${BOLD} [7]${WHITE} System Info${RESET}"
echo -e "${GREEN}${BOLD} [8]${WHITE} Addons Install${RESET}"

echo -e "${CYAN}${BOLD}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${RESET}"
echo -e "${RED}${BOLD} [0] Exit${RESET}"
echo -e "${CYAN}${BOLD}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${RESET}"
echo
echo -ne "${YELLOW}${BOLD}â¤ Enter your choice : ${RESET}"
}

# ================= MAIN LOOP =================
while true; do
show_menu
read -r choice
case $choice in
1) run_remote_script "https://raw.githubusercontent.com/rohitsahoodev-ui/prince/refs/heads/main/pteroinstall" ;;
2) run_remote_script "https://raw.githubusercontent.com/rohitsahoodev-ui/prince/refs/heads/rohitsahoodev-ui-patch-1/wingsptero" ;;
3) run_remote_script "https://raw.githubusercontent.com/rohitsahoodev-ui/prince/refs/heads/rohitsahoodev-ui-patch-1/updateptero" ;;
4) run_remote_script "https://raw.githubusercontent.com/rohitsahoodev-ui/prince/refs/heads/rohitsahoodev-ui-patch-1/uninstallptero" ;;
5) run_remote_script "https://raw.githubusercontent.com/rohitsahoodev-ui/prince/refs/heads/rohitsahoodev-ui-patch-1/Blueprint" ;;
6) run_remote_script "https://raw.githubusercontent.com/rohitsahoodev-ui/prince/refs/heads/rohitsahoodev-ui-patch-1/cloudflareinstall" ;;
7) system_info ;;
8) run_remote_script "https://raw.githubusercontent.com/rohitsahoodev-ui/prince/refs/heads/rohitsahoodev-ui-patch-1/Extension" ;;
0) echo -e "${RED}${BOLD}Bye Bye ğŸ‘‹${RESET}"; exit 0 ;;
*) echo -e "${RED}${BOLD}Invalid option!${RESET}"; sleep 1 ;;
esac
done
